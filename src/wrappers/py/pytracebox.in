#!/usr/bin/env python

import sys; sys.path.insert(1, '@pythondir@')
import logging; logging.getLogger("scapy.runtime").setLevel(logging.ERROR)

import tracebox, random
from scapy.all import IP, TCP, UDP

probe = "%s" % (IP(dst="8.8.8.8", proto="tcp") / 
                TCP(seq=random.randint(0, 2**32-1),
                    sport=random.randint(0, 2**16-1),
                    dport=80, flags="S").build())

def dump_fct(packet):
    print len(packet);
    
res = tracebox.trace(probe, max_ttl = 3)
print res

#for ttl, v in res.iteritems():
#    print ttl, v.router(), v.changed()